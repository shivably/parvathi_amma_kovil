<html>

<head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script>
    function submitData() {
      var validation_error = validateform();
      if (validation_error) {
        return;
      }

      var person = {
        name: $("#name").val(),
        address: $("#address").val(),
        permanent_address: $("#permanent_address").val(),
        phone: $("#phone").val(),
        email: $("#email").val(),
        aadhar: $("#aadhar").val(),
        dob: $("#dob").val()
      }
      console.dir(person);
      $.ajax({
        url: '/api/members/',
        type: 'post',
        dataType: 'json',
        contentType: 'application/json',
        success: function (response_data) {
          if (response_data.response_action == 'redirect') {
            window.location.replace(response_data.url + "?msg=" + response_data.msg);
          }
        },
        data: JSON.stringify(person)
      });
    }
    function validateform() {
      var name = document.addMemberForm.name.value;
      if (name == null || name == "") {
        alert("Please Enter Your Name");
        return true;
      }
      var address = document.addMemberForm.address.value;
      if (address == "") {
        alert("Please Enter Your Address");
        document.addMemberForm.address.focus();
        return true;
      }
      var permanent_address = document.addMemberForm.permanent_address.value;
      if (permanent_address == "") {
        alert("Please Enter Your Permanent_Address");
        document.addMemberForm.permanent_address.focus();
        return true;
      }
      var phone = $("#phone").val();
      console.log(phone)
      var phoneNum = phone.replace(/^[6-9]\d{9}$/);
      console.log(phoneNum)
      if ( phoneNum.length == 10) {
        return false;
      }else{
        alert("Please Enter 10-Digit Mobile Number")
        return true;
      }


      var email = document.addMemberForm.email.value;
      atpos = email.indexOf("@");
      dotpos = email.lastIndexOf(".");

      if (atpos < 1 || (dotpos - atpos < 2)) {
        alert("Please enter correct email")
        document.addMemberForm.email.focus();
        return true;
      }
    }


    //   /* this function is called when we
    //   click on the submit button*/

    //   /*get the value of the textfield using a
    //   combination of name and id*/
    //   //form is the name of the form coded below
    //   //numbers are the name of the inputfield
    //   /*value is used to fetch the value written
    //   in that particular field*/
    //   var phone = document.addMemberForm.phone.value;

    //   /* isNan() function check whether passed variable
    //      is number or not*/
    //   if (isNaN(phone)) {
    //     /*numberText is the ID of span that print "Please enter 
    //     Numeric value" if the value of inputfield is not a number*/
    //     document.getElementById(
    //       "numberText").innerHTML =
    //       "Please enter Numeric value";
    //     return false;
    //   } else {
    //     /*numberText is the ID of span that print 
    //       "Numeric value" if the value of inputfield is a number*/
    //     document.getElementById(
    //       "numberText").innerHTML =
    //       "Numeric value is: " + n;
    //     return true;
    //   }
    // }

  </script>
</head>

<body>
  <!-- A grey horizontal navbar that becomes vertical on small screens -->
  <nav class="navbar navbar-expand-sm bg-secondary navbar-dark">
    <ul class="navbar-nav">
      <li class="nav-item active">
        <a class="nav-link" href="/members">Members</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/add-donation-parvathiamman">Parvathiamman Kovil Vari</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/add-donation-ayyan">Ayyan Kovil Vari</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/expenses">Expenses</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/reports">Reports</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/expense_report">Expense Report</a>
      </li>
    </ul>
  </nav>
  <br />
  <div class="container center_div">
    <h1>Add Member</h1>
    <form action="/api/members/" name="addMemberForm" method="POST">
      <div class="form-group">
        <label for="name">Name</label><span aria-hidden="true" class="required"></span><span
          style=color:#ff0000>*</span>
        <input type="text" class="form-control" id="name" name="name"><br>


        <label for="address">Address</label><span aria-hidden="true" class="required"></span><span
          style=color:#ff0000>*</span>
        <input type="text" class="form-control" id="address" name="address"><br>

        <label for="permanent_address">Permanent Address</label><span aria-hidden="true" class="required"></span>
        <span style=color:#ff0000>*</span>
        <input type="text" class="form-control" id="permanent_address" name="permanent_address"><br>

        <label for="phone">Phone</label><span aria-hidden="true" class="required"></span>
        <span style=color:#ff0000>*</span>
        <input type="number" class="form-control" id="phone" name="phone"><br>

        <label for="email">Email</label><span style=color:#ff0000>*</span>
        <input type="email" class="form-control" id="email" name="email"><br>

        <label for="aadhar">Aadhar</label><span aria-hidden="true" class="required"></span><span
          style=color:#ff0000>*</span>
        <input type="text" class="form-control" id="aadhar" name="aadhar"><br>

        <span aria-hidden="true" class="required"></span>
        <label for="dob">Date Of Birth</label><span aria-hidden="true" class="required"></span><span
          style=color:#ff0000>*</span>
        <input type="date" placeholder="dd/mm/yyyy" class="form-control" id="dob" name="dob"><br>
        <input type="button" value="Add" onclick="submitData()">


      </div>
    </form>
  </div>
</body>

</html>